    # # TODO: determine if the cast is optional
    # flattened_output = tf.cast(flattened_output, tf.float32)
    # flattened_noise = tf.cast(flattened_noise, tf.float32)